---
title : 'start-up in garage'
format :
 dashboard:
    scrolling: true
---

<!-- # {.sidebar}

Sidebar content  -->


# í”„ë¡œì íŠ¸ ì†Œê°œ

## Row 
::: {.card title='ë³€ìˆ˜ ì†Œê°œ'}


# í”„ë¡œì íŠ¸ ëª…
**"ì°¨ê³  ì°½ì—…ì— ì í•©í•œ ë¶€ë™ì‚° ì¸ì‚¬ì´íŠ¸ ëŒ€ì‹œë³´ë“œ"**

<br>

## í”„ë¡œì íŠ¸ ë°°ê²½
ì°¨ê³ (Garage)ëŠ” ë‹¨ìˆœíˆ ì°¨ëŸ‰ì„ ë³´ê´€í•˜ëŠ” ê³µê°„ì„ ë„˜ì–´ ìµœê·¼ì—ëŠ” ê°œì¸ ì°½ê³ , ì†Œê·œëª¨ ì°½ì—… ê³µê°„(ëª©ê³µ, ì •ë¹„, ì „ìì¡°ë¦½ ë“±) ë˜ëŠ” ìŠ¤íƒ€íŠ¸ì—…ì˜ ì²« ì‚¬ë¬´ì‹¤ë¡œ í™œìš©ë˜ëŠ” ë“± ë‹¤ì–‘í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ìˆ˜ìš”ê°€ ì¦ê°€í•˜ê³  ìˆë‹¤.

Ames Housing ë°ì´í„°ì…‹ì€ ì£¼íƒì˜ ë‹¤ì–‘í•œ ìš”ì†Œë¥¼ í¬í•¨í•˜ë©° ì°¨ê³ (Garage) ê´€ë ¨ ì •ë³´ë„ ë‹´ê²¨ ìˆë‹¤. ì´ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì°¨ê³  ì°½ì—…ì— ì í•©í•œ ì£¼íƒì„ íƒìƒ‰í•  ìˆ˜ ìˆëŠ” ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•˜ê³ ì í•œë‹¤.

<br>

## í”„ë¡œì íŠ¸ ëª©í‘œ
- Ames Housing ë°ì´í„°ë¥¼ ë¶„ì„í•˜ì—¬ ì°¨ê³  ê´€ë ¨ ë³€ìˆ˜ì™€ ì£¼íƒ ê°€ì¹˜/íŠ¹ì„± ê°„ì˜ ê´€ê³„ë¥¼ íŒŒì•…í•œë‹¤.

- ë‹¤ì–‘í•œ ì¡°ê±´ì„ ë°˜ì˜í•´ ì°¨ê³  ì°½ì—…ì— ì í•©í•œ ì£¼íƒì˜ íŠ¹ì§•ì„ ë„ì¶œí•œë‹¤.

- ê·¸ ê²°ê³¼ë¥¼ ì§ê´€ì ìœ¼ë¡œ ë³´ì—¬ì£¼ëŠ” ëŒ€ì‹œë³´ë“œë¥¼ êµ¬ì¶•í•œë‹¤.

- ì‚¬ìš©ìê°€ ì°¨ê³ ì§€ ì¡°ê±´ì„ ì„¤ì •í•˜ë©´ ì°½ì—… ì í•© ì£¼íƒì„ í•„í„°ë§ ë° ì¶”ì²œí•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

<br>

## ì„¸ë¶€ ë¶„ì„ í•­ëª©
### 1. ì°¨ê³  ê´€ë ¨ ë³€ìˆ˜ íƒìƒ‰


- `GarageType`: ì°¨ê³ ì˜ ìœ í˜• (Detached, Attached, BuiltIn ë“±)

- `GarageCars`: ì°¨ê³  ì°¨ëŸ‰ ìˆ˜ (ê³µê°„ í¬ê¸° ëŒ€ì²´ ê°€ëŠ¥)

- `GarageArea`: ì°¨ê³  ë©´ì  (ì°½ì—… ê°€ëŠ¥ ìµœì†Œ ê³µê°„ ì„¤ì • ê°€ëŠ¥)

- `GarageFinish`: ë‚´ë¶€ ë§ˆê° ìˆ˜ì¤€ (ì°½ì—… ìš©ë„ ì í•©ë„ íŒë‹¨)

- `GarageYrBlt`: ì°¨ê³  ê±´ì¶•ë…„ë„ (ìƒëŒ€ì  ë…¸í›„ë„ í‰ê°€)

- `GarageQual`: ì°¨ê³ ì˜ í’ˆì§ˆ

- `GarageCond`: ì°¨ê³ ì˜ ìƒíƒœ

:::


# EDA & Preprocessing

```{python}
import pandas as pd

# ames_df = pd.read_csv('week10/startup-in-garage/data/ames.csv' )
ames_df = pd.read_csv('./data/ames.csv' )

garage_cols = ['GarageType', 'GarageYrBlt', 'GarageFinish', 'GarageCars','GarageArea', 'GarageQual', 'GarageCond']

```




## Row 

```{python}
ames_df[garage_cols].isnull().sum()

```

```{python}
ames_df = ames_df.dropna(subset=garage_cols)

```




```{python}
#| fig-width: 3
#| fig-height: 5
#| fig-align: center
#| fig-cap: "ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ"
import matplotlib.pyplot as plt
import seaborn as sns
# ìƒê´€ê´€ê³„ íˆíŠ¸ë§µ
numeric_columns = ['SalePrice', 'GarageYrBlt', 'GarageCars', 'GarageArea']
corr_matrix = ames_df[numeric_columns].corr()
plt.figure(figsize=(5, 3))
sns.heatmap(corr_matrix, annot=True, cmap='coolwarm', fmt='.2f', linewidths=0.5)
plt.title('Correlation Heatmap of Garage and Sale Price Variables')
plt.show()
```


## Row 



```{python}
# ì´ìƒì¹˜ ì œê±°
# GarageArea IQRì˜í•´ ì´ìƒì¹˜ ì œê±°ëœ ì´ìœ  
Q1 = ames_df['GarageArea'].quantile(0.25)
Q3 = ames_df['GarageArea'].quantile(0.75)
IQR = Q3 - Q1
upper_bound = Q3 + 1.5 * IQR

print(ames_df[ames_df['GarageArea'] > upper_bound].shape[0]) # upper_bound ì´ìƒ ë°ì´í„° 56ê°œ


print(ames_df['SalePrice'].mean()) # ì´ìƒì¹˜ ì œê±°ì „ í‰ê·  salepriceëŠ” 181804

print(ames_df[ames_df['GarageArea'] > upper_bound]['SalePrice'].mean())
# upper_bound ì´ìƒ ë°ì´í„°ì˜ salepriceëŠ” 303685ìœ¼ë¡œ ìƒë‹¹íˆ ë¹„ì‹¸ë‹¤

ames_df = ames_df[ames_df['GarageArea'] < upper_bound]  # ë”°ë¼ì„œ upper_boundì— í•´ë‹¹ë˜ëŠ” ë°ì´í„° ì œê±°
print(ames_df.shape)


```




## Row 

<!-- ::: {.card title="test"} -->
## ìœ„ì¹˜ ê¸°ë°˜ GarageArea ì‹œê°í™”
```{python}

# ì „ì²˜ë¦¬ 
# ames_df_clean = ames_df.dropna(subset=garage_cols)


import plotly.express as px

# GarageArea
# Plotly scatter_mapbox ì‹œê°í™”
fig = px.scatter_mapbox(
    ames_df,
    lat="Latitude",
    lon="Longitude",
    color="GarageArea",              # ìƒ‰ê¹”ë¡œ ì§‘ê°’ í‘œí˜„
    size="GarageArea",               # ì  í¬ê¸°ë¡œë„ ì§‘ê°’ í‘œí˜„
    color_continuous_scale= "blues",  # ìƒ‰ìƒ íŒ”ë ˆíŠ¸
    size_max=13,
    zoom=11.5,
    height=650,
    width=800,
    mapbox_style="carto-positron",  # ê¹”ë”í•œ ì§€ë„ ìŠ¤íƒ€ì¼
    title="Ames Housing: ìœ„ì¹˜ ê¸°ë°˜ ì§‘ê°’ ì‹œê°í™”"
)

fig.update_layout(

    mapbox_center={"lat": 42.02601, "lon": -93.63975},
    margin={"r":0,"t":30,"l":0,"b":0})

# fig.show()

```

<!-- ::: -->


## Row


###  ì›í•˜ëŠ” ì°¨ê³ ëŠ” ì–´ë–¤ ì¡°ê±´ì„ ë§Œì¡±í•´ì•¼ í• ê¹Œ?
```{python}
import pandas as pd
from itables import init_notebook_mode, show

codebook = ames_df.copy()
components = codebook[garage_cols+['SalePrice']]

# Initialize the itables mode
init_notebook_mode(all_interactive=True)

# Display the table with specific container style
show(components, buttons=['copy', 'excel', 'pdf'], scrollY="1000px", scrollCollapse=True)

```



# Test

## Row {height=30%}

```{python}
# GarageType ê°¯ìˆ˜
garage_counts = ames_df['GarageType'].value_counts().reset_index()
garage_counts.columns = ['GarageType', 'Count']
fig = px.pie(
    garage_counts,
    names='GarageType',
    values='Count',
    hole=0.4,
    title='Distribution of Garage Types (Donut Chart)'
)
_=fig.update_traces(
    textinfo='percent+label',
    marker=dict(line=dict(color='white', width=2))
)
_=fig.update_layout(
    showlegend=True,
    width=700,
    height=500
)
fig.show()
```



```{python}
# GarageFinish ê°¯ìˆ˜ (ê³ ì •)
garagefinish_counts = ames_df['GarageFinish'].value_counts().reset_index()
garagefinish_counts.columns = ['GarageFinish', 'Count']
color_map = {
    'Unf': '#636EFA',
    'RFn': '#EF553B',
    'Fin': '#00CC96'
}
fig = px.pie(garagefinish_counts, 
             names='GarageFinish', 
             values='Count', 
             hole=0.4, 
             title='Distribution of Garage Finish Types')
_=fig.update_layout(
    showlegend=True,
    width=700,
    height=500
)
fig.show()
```



## Row {height=30%}


```{python}
# GarageQual ê°¯ìˆ˜
garage_counts = ames_df['GarageQual'].value_counts().reset_index()
garage_counts.columns = ['GarageQual', 'Count']
fig = px.pie(
    garage_counts,
    names='GarageQual',
    values='Count',
    hole=0.4,
    title='Distribution of GarageQual (Donut Chart)'
)
_=fig.update_traces(textinfo='percent+label',
    marker=dict(line=dict(color='white', width=2)),
                  rotation=90)
_=fig.update_layout(
    showlegend=True,
    width=700,
    height=500
)
fig.show()

```
 


```{python}
# GarageCond ê°¯ìˆ˜
garagecond_counts = ames_df['GarageCond'].value_counts().reset_index()
garagecond_counts.columns = ['GarageCond', 'Count']
fig = px.pie(
    garagecond_counts,
    names='GarageCond',
    values='Count',
    hole=0.4,
    title='Distribution of Garage Condition (Donut Chart)'
)
_=fig.update_traces(
    textinfo='percent+label',
    marker=dict(line=dict(color='white', width=2)),
    rotation=90 
)
_=fig.update_layout(
    showlegend=True,
    width=700,
    height=500
)
fig.show()

```





## Row {height=40%}


```{python}
# Yearbuiltì™€ GarageArea ê´€ê³„
yearly_avg_area = ames_df.groupby('GarageYrBlt')['GarageArea'].mean()
yearly_avg_area_df = yearly_avg_area.reset_index()
yearly_avg_area_df.columns = ['GarageYrBlt', 'AvgGarageArea']
fig = px.line(
    yearly_avg_area_df,
    x='GarageYrBlt',
    y='AvgGarageArea',
    title='Average Garage Area by Built Year',
    markers=True
)
_=fig.update_traces(line=dict(color='firebrick'))  # ì„  ìƒ‰ê¹” ì„¤ì •
_=fig.update_layout(
    xaxis_title='Built Year (GarageYrBlt)',
    yaxis_title='Average Garage Area (sqft)',
    template='plotly_white',
    width=800,
    height=500
)
fig.show()
```



```{python}
# Yearbuiltì™€ GarageCarsì˜ ê´€ê³„ (í‰ê· )
yearly_avg = ames_df.groupby('GarageYrBlt')['GarageCars'].mean()
yearly_avg_df = yearly_avg.reset_index()
yearly_avg_df.columns = ['GarageYrBlt', 'AvgGarageCars']
fig = px.line(
    yearly_avg_df,
    x='GarageYrBlt',
    y='AvgGarageCars',
    title='Average Number of Garage Cars by Built Year',
    markers=True
)
_=fig.update_traces(line=dict(color='green'))  # ì„  ìƒ‰ê¹” ì„¤ì •
_=fig.update_layout(
    xaxis_title='Built Year (GarageYrBlt)',
    yaxis_title='Average Garage Cars',
    template='plotly_white',
    width=800,
    height=500
)
fig.show()
```



# íˆíŠ¸ë§µ ë° ë°•ìŠ¤í”Œë¡¯

## Row {height=50%}

```{python}


import seaborn as sns
import matplotlib.pyplot as plt

numeric_columns = ['SalePrice', 'GarageCars', 'GarageArea']
corr_matrix = ames_df[numeric_columns].corr()
plt.figure(figsize=(10, 6))
sns.heatmap(corr_matrix, 
            annot=True, 
            cmap='coolwarm', 
            fmt='.2f', 
            linewidths=0.5, 
            vmin=-1, vmax=1)

plt.title('Correlation Heatmap of Garage and Sale Price Variables')
plt.tight_layout()  # ì—¬ë°± ì •ë¦¬
plt.show()
```



# ì§€ë„ ì‹œê°í™”

## Row {height =50%}
<!-- row1 -->

::: {card}

<iframe src="garage_map.html" width="100%" height="600px" style="border:none;"></iframe>

:::


```{python}
import plotly.express as px

# GarageArea
# Plotly scatter_mapbox ì‹œê°í™”
fig = px.scatter_mapbox(
    ames_df,
    lat="Latitude",
    lon="Longitude",
    color="GarageArea",              # ìƒ‰ê¹”ë¡œ ì§‘ê°’ í‘œí˜„
    size="GarageArea",               # ì  í¬ê¸°ë¡œë„ ì§‘ê°’ í‘œí˜„
    color_continuous_scale= "blues",  # ìƒ‰ìƒ íŒ”ë ˆíŠ¸
    size_max=13,
    zoom=11.5,
    height=650,
    width=800,
    mapbox_style="carto-positron",  # ê¹”ë”í•œ ì§€ë„ ìŠ¤íƒ€ì¼
    title="Ames Housing: ìœ„ì¹˜ ê¸°ë°˜ ì§‘ê°’ ì‹œê°í™”"
)

fig.update_layout(

    mapbox_center={"lat": 42.02601, "lon": -93.63975},
    margin={"r":0,"t":30,"l":0,"b":0})

# fig.show()

```

## Row {height =50%}

```{python}

import plotly.express as px

# GarageArea
# Plotly scatter_mapbox ì‹œê°í™”
fig = px.scatter_mapbox(
    ames_df,
    lat="Latitude",
    lon="Longitude",
    color="GarageCars",              # ìƒ‰ê¹”ë¡œ ì§‘ê°’ í‘œí˜„
    size="GarageCars",               # ì  í¬ê¸°ë¡œë„ ì§‘ê°’ í‘œí˜„
    color_continuous_scale= "reds",  # ìƒ‰ìƒ íŒ”ë ˆíŠ¸
    size_max=13,
    zoom=11.5,
    height=650,
    width=800,
    mapbox_style="carto-positron",  # ê¹”ë”í•œ ì§€ë„ ìŠ¤íƒ€ì¼
    title="Ames Housing: ìœ„ì¹˜ ê¸°ë°˜ ì§‘ê°’ ì‹œê°í™”"
)

fig.update_layout(
    dragmode='zoom',        # ë˜ëŠ” 'pan'
    mapbox_center={"lat": 42.02601, "lon": -93.63975},
    margin={"r":0,"t":30,"l":0,"b":0})

```

row2



## Row 

# dropdown

```{python}
import plotly.express as px
import plotly.graph_objects as go
import pandas as pd

# ê³ ì • í¬ê¸°ìš© ê°€ì§œ size
ames_df['UniformSize'] = 10

# ì‚¬ìš©í•  ì»¬ëŸ¼ ë¦¬ìŠ¤íŠ¸
category_cols = ['GarageQual', 'GarageCond']
default_col = category_cols[0]

# íŒŒë€ìƒ‰ ê³„ì—´ë¡œ ìƒ‰ìƒ ì§€ì • (ì—°í•œ íŒŒë‘ â†’ ì§„í•œ íŒŒë‘)
blue_gradient = ['#90caf9', '#64b5f6', '#2196f3', '#1e3a8a', '#00008b']
qual_order = ['Po', 'Fa', 'TA', 'Gd', 'Ex']  # ìˆœì„œëŒ€ë¡œ ì„¤ì •

# color_mapì„ ì´ìš©í•˜ì—¬ ìƒ‰ìƒ ë§µí•‘
color_map = dict(zip(qual_order, blue_gradient))

# ê³µí†µ fig ì„¤ì • (layoutë§Œ ë¨¼ì € ì§€ì •)
fig = go.Figure()

# ì´ˆê¸° trace ì¶”ê°€
initial_trace = px.scatter_mapbox(
    ames_df,
    lat="Latitude",
    lon="Longitude",
    color=default_col,
    hover_data=["SalePrice", default_col],
    size="UniformSize",
    size_max=11,
    zoom=12,
    mapbox_style="carto-positron",
    category_orders={default_col: qual_order},  # ìˆœì„œ ì§€ì •
    color_discrete_map=color_map               # ìƒ‰ìƒ ë§¤í•‘ ì ìš©
)

# figì— ì²« trace ë³µì‚¬
for trace in initial_trace.data:
    fig.add_trace(trace)

# layout ë³µì‚¬
_=fig.update_layout(initial_trace.layout)

# ì¤‘ì‹¬ ë° ì‚¬ì´ì¦ˆ ê³ ì •
_=fig.update_layout(
    mapbox_center={"lat": 42.02601, "lon": -93.63975},
    height=700,
    width=1000,
    margin={"r": 0, "t": 50, "l": 0, "b": 0},
    title=f"ğŸ  {default_col} ë³„ ì£¼íƒ ìœ„ì¹˜ ì‹œê°í™”"
)

# dropdownì„ ìœ„í•œ ë²„íŠ¼ ìƒì„±
dropdown_buttons = []
for col in category_cols:
    temp_fig = px.scatter_mapbox(
        ames_df,
        lat="Latitude",
        lon="Longitude",
        color=col,
        hover_data=["SalePrice", col],
        size="UniformSize",
        size_max=11,
        zoom=12,
        mapbox_style="carto-positron",
        category_orders={col: qual_order},  # ìˆœì„œ ì§€ì •
        color_discrete_map=color_map         # ìƒ‰ìƒ ë§¤í•‘ ì ìš©
    )

    # button: trace êµì²´
    button = dict(
        label=col,
        method="update",
        args=[
            {'lat': [trace.lat for trace in temp_fig.data],
             'lon': [trace.lon for trace in temp_fig.data],
             'marker': [trace.marker for trace in temp_fig.data],
             'hovertext': [trace.hovertext for trace in temp_fig.data],
             'customdata': [trace.customdata for trace in temp_fig.data],
             'name': [trace.name for trace in temp_fig.data]},
            {'title': f"ğŸ  {col} ë³„ ì£¼íƒ ìœ„ì¹˜ ì‹œê°í™”"}
        ]
    )
    dropdown_buttons.append(button)

# ë²„íŠ¼ ì¶”ê°€
_=fig.update_layout(
    updatemenus=[
        dict(
            buttons=dropdown_buttons,
            direction='down',
            showactive=True,
            x=0.01,
            y=1.05,
            xanchor='left',
            yanchor='top'
        )
    ]
)

fig.show()

```